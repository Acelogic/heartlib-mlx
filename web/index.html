<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HeartMuLa</title>
    <link rel="icon" type="image/png" href="favicon.png">
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
</head>
<body>
    <div class="app">
        <!-- Left Sidebar -->
        <aside class="sidebar">
            <div class="logo">HEART</div>

            <nav class="nav-menu">
                <a href="#" class="nav-item active">
                    <svg viewBox="0 0 24 24" fill="currentColor"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/></svg>
                    Create
                </a>
                <a href="#" class="nav-item">
                    <svg viewBox="0 0 24 24" fill="currentColor"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg>
                    Home
                </a>
                <a href="#" class="nav-item">
                    <svg viewBox="0 0 24 24" fill="currentColor"><path d="M20 6h-8l-2-2H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2z"/></svg>
                    Studio
                </a>
                <a href="#" class="nav-item">
                    <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"/></svg>
                    Library
                </a>
                <a href="#" class="nav-item">
                    <svg viewBox="0 0 24 24" fill="currentColor"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
                    Search
                </a>
                <a href="#" class="nav-item">
                    <svg viewBox="0 0 24 24" fill="currentColor"><path d="M19.14 12.94c.04-.31.06-.63.06-.94 0-.31-.02-.63-.06-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.04.31-.06.63-.06.94s.02.63.06.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/></svg>
                    Settings
                </a>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Lyrics Section -->
            <section class="section">
                <div class="section-header" onclick="toggleSection('lyrics')">
                    <svg class="chevron" viewBox="0 0 24 24" fill="currentColor"><path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/></svg>
                    <span>Lyrics</span>
                    <button class="magic-btn" title="Surprise Me!" onclick="surpriseMe(); event.stopPropagation();">
                        <svg viewBox="0 0 24 24" fill="currentColor"><path d="M7.5 5.6L10 7 8.6 4.5 10 2 7.5 3.4 5 2l1.4 2.5L5 7zm12 9.8L17 14l1.4 2.5L17 19l2.5-1.4L22 19l-1.4-2.5L22 14zM22 2l-2.5 1.4L17 2l1.4 2.5L17 7l2.5-1.4L22 7l-1.4-2.5zm-7.63 5.29a.996.996 0 0 0-1.41 0L1.29 18.96a.996.996 0 0 0 0 1.41l2.34 2.34c.39.39 1.02.39 1.41 0L16.7 11.05a.996.996 0 0 0 0-1.41l-2.33-2.35zm-1.03 5.49l-2.12-2.12 2.44-2.44 2.12 2.12-2.44 2.44z"/></svg>
                    </button>
                </div>
                <div class="section-content" id="lyrics-section">
                    <textarea
                        id="lyrics-input"
                        placeholder="Write some lyrics or a prompt — or leave blank for instrumental"
                        rows="6"
                    ></textarea>
                    <button class="expand-btn" title="Expand">
                        <svg viewBox="0 0 24 24" fill="currentColor"><path d="M21 11V3h-8l3.29 3.29-10 10L3 13v8h8l-3.29-3.29 10-10z"/></svg>
                    </button>
                </div>
            </section>

            <!-- Styles Section -->
            <section class="section">
                <div class="section-header" onclick="toggleSection('styles')">
                    <svg class="chevron" viewBox="0 0 24 24" fill="currentColor"><path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/></svg>
                    <span>Styles</span>
                </div>
                <div class="section-content" id="styles-section">
                    <input
                        type="text"
                        id="styles-input"
                        placeholder="femenina, augment, cori, émotion, high tension"
                        value="electronic, ambient, instrumental"
                    >
                    <div class="tags-row">
                        <button class="eq-btn" title="Equalizer">
                            <svg viewBox="0 0 24 24" fill="currentColor"><path d="M3 17v2h6v-2H3zM3 5v2h10V5H3zm10 16v-2h8v-2h-8v-2h-2v6h2zM7 9v2H3v2h4v2h2V9H7zm14 4v-2H11v2h10zm-6-4h2V7h4V5h-4V3h-2v6z"/></svg>
                        </button>
                        <button class="tag-pill" onclick="addTag('femenina')">+ femenina</button>
                        <button class="tag-pill" onclick="addTag('augment')">+ augment</button>
                        <button class="tag-pill" onclick="addTag('cori')">+ cori</button>
                        <button class="tag-pill" onclick="addTag('pop')">+ pop</button>
                        <button class="tag-pill" onclick="addTag('rock')">+ rock</button>
                        <button class="tag-pill" onclick="addTag('jazz')">+ jazz</button>
                        <button class="tag-pill" onclick="addTag('piano')">+ piano</button>
                        <button class="tag-pill" onclick="addTag('female vocal')">+ female vocal</button>
                    </div>
                </div>
            </section>

            <!-- Advanced Options -->
            <section class="section collapsed">
                <div class="section-header" onclick="toggleSection('advanced')">
                    <svg class="chevron" viewBox="0 0 24 24" fill="currentColor"><path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/></svg>
                    <span>Advanced Options</span>
                </div>
                <div class="section-content hidden" id="advanced-section">
                    <!-- Exclude styles -->
                    <div class="option-row">
                        <div class="option-icon">
                            <svg viewBox="0 0 24 24" fill="currentColor"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
                        </div>
                        <input type="text" placeholder="Exclude styles" class="option-input">
                    </div>

                    <!-- Vocal Gender -->
                    <div class="option-row">
                        <span class="option-label">Vocal Gender <span class="info-icon">ⓘ</span></span>
                        <div class="toggle-group">
                            <button class="toggle-btn" onclick="setVocalGender('male')">Male</button>
                            <button class="toggle-btn active" onclick="setVocalGender('female')">Female</button>
                        </div>
                    </div>

                    <!-- Lyrics Mode -->
                    <div class="option-row">
                        <span class="option-label">Lyrics Mode <span class="info-icon">ⓘ</span></span>
                        <div class="toggle-group">
                            <button class="toggle-btn active" onclick="setLyricsMode('manual')">Manual</button>
                            <button class="toggle-btn" onclick="setLyricsMode('auto')">Auto</button>
                        </div>
                    </div>

                    <!-- Weirdness (Temperature) Slider -->
                    <div class="slider-row">
                        <span class="slider-label">Weirdness <span class="info-icon" title="Higher = more creative/unpredictable">ⓘ</span></span>
                        <div class="slider-container">
                            <input type="range" id="temperature-slider" min="0.5" max="1.5" step="0.1" value="1.0">
                            <span class="slider-value" id="temperature-value">1.0</span>
                        </div>
                    </div>

                    <!-- Style Influence Slider -->
                    <div class="slider-row">
                        <span class="slider-label">Style Influence <span class="info-icon" title="Higher = stronger adherence to style tags">ⓘ</span></span>
                        <div class="slider-container">
                            <input type="range" id="cfg-slider" min="1" max="4" step="0.1" value="1.5">
                            <span class="slider-value" id="cfg-value">1.5</span>
                        </div>
                    </div>

                    <!-- Duration -->
                    <div class="slider-row">
                        <span class="slider-label">Duration (seconds)</span>
                        <div class="slider-container">
                            <input type="range" id="duration-slider" min="5" max="120" step="5" value="30">
                            <span class="slider-value" id="duration-value">30s</span>
                        </div>
                    </div>

                    <!-- Song Title -->
                    <div class="option-row">
                        <div class="option-icon">
                            <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"/></svg>
                        </div>
                        <input type="text" placeholder="Song Title (Optional)" class="option-input" id="song-title">
                    </div>

                </div>
            </section>

            <!-- Create Button -->
            <button class="create-btn" id="create-btn" onclick="generateMusic()">
                <svg viewBox="0 0 24 24" fill="currentColor"><path d="M7.5 5.6L10 7 8.6 4.5 10 2 7.5 3.4 5 2l1.4 2.5L5 7zm12 9.8L17 14l1.4 2.5L17 19l2.5-1.4L22 19l-1.4-2.5L22 14z"/></svg>
                Create
            </button>

            <!-- Progress -->
            <div class="progress-container hidden" id="progress-container">
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>
                <div class="progress-row">
                    <span class="progress-text" id="progress-text">Generating...</span>
                    <button class="cancel-btn" id="cancel-btn" onclick="cancelGeneration()">Cancel</button>
                </div>
            </div>

            <!-- Output Info -->
            <div class="output-section hidden" id="output-section">
                <div class="output-info" id="output-info"></div>
            </div>
        </main>

        <!-- Right Panel (Workspace) -->
        <aside class="workspace">
            <div class="workspace-header">
                <span class="workspace-title">Workspaces</span>
                <span class="workspace-breadcrumb">› My Workspace</span>
            </div>
            <div class="workspace-toolbar">
                <div class="search-box">
                    <svg viewBox="0 0 24 24" fill="currentColor"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
                    <input type="text" placeholder="Search">
                </div>
                <button class="filter-btn">
                    <svg viewBox="0 0 24 24" fill="currentColor"><path d="M10 18h4v-2h-4v2zM3 6v2h18V6H3zm3 7h12v-2H6v2z"/></svg>
                    Filters (3)
                </button>
                <button class="sort-btn">
                    <svg viewBox="0 0 24 24" fill="currentColor"><path d="M3 18h6v-2H3v2zM3 6v2h18V6H3zm0 7h12v-2H3v2z"/></svg>
                    Newest
                </button>
            </div>
            <div class="workspace-list" id="workspace-list">
                <!-- Songs will be added here dynamically -->
                <div class="empty-state">
                    <p>Your generated songs will appear here</p>
                </div>
            </div>
        </aside>
    </div>

    <!-- Hidden Audio Element (persists across views) -->
    <audio id="audio-player"></audio>

    <!-- Bottom Player Bar -->
    <div class="player-bar hidden" id="player-bar">
        <!-- Left: Track Info -->
        <div class="player-track">
            <div class="track-thumb" id="track-thumb"></div>
            <div class="track-info">
                <span class="track-title" id="player-title">-</span>
                <span class="track-artist">HeartMuLa</span>
            </div>
        </div>

        <!-- Center: Controls + Progress -->
        <div class="player-center">
            <div class="player-controls">
                <button class="player-btn shuffle-btn" id="shuffle-btn" onclick="toggleShuffle()" title="Shuffle">
                    <svg viewBox="0 0 24 24" fill="currentColor"><path d="M10.59 9.17L5.41 4 4 5.41l5.17 5.17 1.42-1.41zM14.5 4l2.04 2.04L4 18.59 5.41 20 17.96 7.46 20 9.5V4h-5.5zm.33 9.41l-1.41 1.41 3.13 3.13L14.5 20H20v-5.5l-2.04 2.04-3.13-3.13z"/></svg>
                </button>
                <button class="player-btn" onclick="previousTrack()" title="Previous">
                    <svg viewBox="0 0 24 24" fill="currentColor"><path d="M6 6h2v12H6zm3.5 6l8.5 6V6z"/></svg>
                </button>
                <button class="player-btn play-btn" onclick="togglePlay()" title="Play/Pause">
                    <svg viewBox="0 0 24 24" fill="currentColor" id="play-icon"><path d="M8 5v14l11-7z"/></svg>
                </button>
                <button class="player-btn" onclick="nextTrack()" title="Next">
                    <svg viewBox="0 0 24 24" fill="currentColor"><path d="M6 18l8.5-6L6 6v12zM16 6v12h2V6h-2z"/></svg>
                </button>
                <button class="player-btn repeat-btn" id="repeat-btn" onclick="toggleRepeat()" title="Repeat">
                    <svg viewBox="0 0 24 24" fill="currentColor"><path d="M7 7h10v3l4-4-4-4v3H5v6h2V7zm10 10H7v-3l-4 4 4 4v-3h12v-6h-2v4z"/></svg>
                </button>
            </div>
            <div class="player-progress">
                <span class="time-current" id="time-current">0:00</span>
                <div class="progress-track" id="progress-track" onclick="seekTo(event)">
                    <div class="progress-played" id="progress-played">
                        <div class="progress-handle" id="progress-handle"></div>
                    </div>
                </div>
                <span class="time-total" id="time-total">0:00</span>
            </div>
        </div>

        <!-- Right: Actions + Volume -->
        <div class="player-actions">
            <button class="player-action-btn" onclick="toggleQueue()" title="Queue">
                <svg viewBox="0 0 24 24" fill="currentColor"><path d="M15 6H3v2h12V6zm0 4H3v2h12v-2zM3 16h8v-2H3v2zM17 6v8.18c-.31-.11-.65-.18-1-.18-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3V8h3V6h-5z"/></svg>
            </button>
            <button class="player-action-btn like-btn" id="like-btn" onclick="toggleLike()" title="Like">
                <svg viewBox="0 0 24 24" fill="currentColor"><path d="M1 21h4V9H1v12zm22-11c0-1.1-.9-2-2-2h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 1 7.59 7.59C7.22 7.95 7 8.45 7 9v10c0 1.1.9 2 2 2h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73v-2z"/></svg>
            </button>
            <button class="player-action-btn dislike-btn" id="dislike-btn" onclick="toggleDislike()" title="Dislike">
                <svg viewBox="0 0 24 24" fill="currentColor"><path d="M15 3H6c-.83 0-1.54.5-1.84 1.22l-3.02 7.05c-.09.23-.14.47-.14.73v2c0 1.1.9 2 2 2h6.31l-.95 4.57-.03.32c0 .41.17.79.44 1.06L9.83 23l6.59-6.59c.36-.36.58-.86.58-1.41V5c0-1.1-.9-2-2-2zm4 0v12h4V3h-4z"/></svg>
            </button>
            <button class="player-action-btn" onclick="downloadTrack()" title="Download">
                <svg viewBox="0 0 24 24" fill="currentColor"><path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/></svg>
            </button>
            <div class="volume-control">
                <button class="player-action-btn volume-btn" onclick="toggleMute()" title="Volume">
                    <svg viewBox="0 0 24 24" fill="currentColor" id="volume-icon"><path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/></svg>
                </button>
                <div class="volume-slider-wrap">
                    <input type="range" class="volume-slider" id="volume-slider" min="0" max="100" value="80" oninput="setVolume(this.value)">
                </div>
            </div>
        </div>
    </div>

    <!-- Art Generation Toast (bottom right, above player) -->
    <div class="art-toast hidden" id="art-toast">
        <div class="art-toast-icon">
            <svg class="spin" viewBox="0 0 24 24" fill="currentColor"><path d="M12 4V2A10 10 0 0 0 2 12h2a8 8 0 0 1 8-8z"/></svg>
        </div>
        <div class="art-toast-content">
            <span class="art-toast-title">Generating Album Art</span>
            <span class="art-toast-subtitle" id="art-toast-subtitle">Processing...</span>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
